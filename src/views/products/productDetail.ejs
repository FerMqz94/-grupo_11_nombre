<!DOCTYPE html>
<html lang="es">

<%- include("../partials/head",{view : product.name} ) %>


  <body class="vista-producto">

    <%- include("../partials/header", {productosDetalle: "black" , registro: true,ingreso: true}) %>



      <main class="vista-producto">
        <div class="contenedor-busqueda">
          <a href="/" class="inicio">Inicio/</a>
          <a href="/productDetail" class="productos">Productos/</a>
          <a href="#" class="abrigos">
            <%= product.category?.name %>/
          </a>
          <a class="blazer">
            <%= product.name %>
          </a>
        </div>


        <!---CONTENEDORES DE LAS VISTAS DEL PRODUCTO-->

        <section class="visualizacion-producto">

          <div class="contenedor-vistas-imagenes">

            <div class="glider-contain">
              <div class="glider">
                <!--img 1-->
                <% product.images.forEach(img=> { %>
                  <% if (img) { %>
                    <div>
                      <div class="card">
                        <span id="heart-second" value="So" class="heart"><i onclick="wishList()" class="fas fa-heart"></i></span>
                    <img src="/images/products/<%= img.name %>" class="first-image">
                  
                  </div>
                      <!--<div class="contenedor-blazerOver-principal">
                        <i class="fa-solid fa-magnifying-glass"></i>
                        <i class="fa-regular fa-heart"></i>
                        <div class="contenedor-img-principal">
                          <img class="blazer-over-principal" src="/images/products/<%= img.name %>"
                            alt="<%= product.name %>">
                        </div>
                      </div>--->
                    </div>
                    <% } %>
                      <% }) %>
              </div>
              <% if (product.images[1]) { %>
                <button aria-label="Previous" class="glider-prev"><i class="fa-solid fa-angle-left"></i></button>
                <button aria-label="Next" class="glider-next"><i class="fa-solid fa-angle-right"></i></button>
                <% } else {%>
                  <% } %>
                    <div rol="tablist" class="dots"></div>
            </div>

            <article class="contenedor-descripcion" style="width: 100%;">
              <p class="descripcion">
                <%= product.description%>
              </p>
              <h5 class="descripcion-destacada">
                <%= product.featuredDescription %>
                  </p>
            </article>
          </div>





          <!--CONTENEDOR GLOBAL DE TODA LA DATA DEL PRODUCTO QUE NO SEAN FOTOS-->
          <div class="contenedor-global-info-producto">


            <!---CONTENEDOR DE DATOS PRINCIPALES DEL PRODUCTO NOMBRE-PRECIO-TALLE-->
            <div class="nombre-precio-talle">
              <h2 class="blazer-over">
                <%= product.name%>
              </h2>
              <P class="precio">$<%= product.price %>
              </P>
              <P class="talle">TALLE: <span class="view-size"></span></p>

              <div class="talles">
                  <% const sizesSpanish={ 1: "uno" , 2: "dos" , 3: "tres" , 4: "cuatro" , 5: "cinco" }; %>
                    <% const sizesIds=product.sizes.map(size=> size.id) %>
                      <% sizes.forEach(s=> { %>
                        <% if (sizesIds.includes(s.id)) { %>
                          <div class="<%= sizesSpanish[s.id]%>">
                            <button type="button" style="margin-left: 4px; margin-top: 10px;" name="button-sizes" class="boton-<%= sizesSpanish[s.id]%>" onclick="getSize('<%= s.size %>'); showSize('<%= s.size %>')">
                              <%= s.size %>
                            </button>
                          </div>
                          <% } else {%>
                            <div class="<%= sizesSpanish[s.id]%>">
                            <button type="button" style="margin-left: 4px; margin-top: 10px; border: 2px solid var(--gris85); color: var(--gris85);" name="button-sizes" class="boton-<%= sizesSpanish[s.id]%>" onclick="showMsgNoSize('<%= s.size %>')" > <%= s.size %></button>
                            </div>
                        <% } %>
                        <% }) %>
              </div>


              <div style="margin-top: 10px;">
                <p>Colores</p>
                <% const colorNames=product.colors.map(color=> color.name) %>
                  <% colors.forEach(c=> { %>
                    <% if (colorNames.includes(c.name)) { %>
                      <button class="colores" <% /* eslint-disable css-propertyvalueexpected */ %> id="<%= c.id %>"
                        style="background-color: <%= c.hexadecimal %>; border-radius: 100px; height: 30px; width:
                          30px; border: 1.5px solid black" onclick="getcolor('<%= c.id %>'); changeBorder('<%= c.id %>')">
                      </button>
                      <% } %>
                        <% }) %>
              </div>
             

              <div class="cantidad-carrito">
                <!-- <form class="form-carrito" action="/productDetail" method="POST"> -->
                <div class="form-carrito">
                  <label class="label-carrito" for="cantidad">CANTIDAD</label>
                  <input class="input-carrito" type="number" name="cantidad" value="" id="cantidad" placeholder="1">
                  <div class="contenedor-boton-carrito">
                    <button type="submit" class="agregar-carrito"
                      onclick="addProductCart('<%= product.id %>','<%= product.colors[0].id %>','<%= product.sizes[0].size %>','<%= product.images[0].name %>')">
                      <!-- <a href="#">  -->
                      AGREGAR AL CARRITO
                      <!-- </a> -->
                    </button>
                  </div>
                </div>
                <!-- </form> -->
              </div>

              <!---CONTENEDOR ENVIO Y MEDIOS DE ENVIO-->
              <!-- ESTA PARTE FUE COMENTADA DEBIDO A QUE AUN NO LE DAN USO -->

              <!-- <div class="envio">
                <form action="#" method="POST" class="form-carrito"> SI SE VA USAR EL FORM ELIMINEN EL DIV CON LA CLASE form-carrito 
                  <div  class="form-carrito"> SI NO USAN EL FOR ELIMINENLO Y POR PARTE DEL CSS ESTA SOLUCIONADO POR SI QUIEREN ELIMINAR ALGUNO DE LOS DOS
                  <i class="fa-solid fa-truck"></i>
                  <label class="label-carrito" for="medioEnvio">Medios de envío</label>
                  <input class="input-carrito" type="number" name="envio" value="" id="medioEnvio"
                    placeholder="Tu código postal">
                  <button type="submit" class="boton-calcular">CALCULAR</button>
                  <p class="nose-postal">No sé mi código postal</p>
                </div>
                </form> 
              </div> -->

              <!---CONTENEDOR DE INFO ADICIONAL PARA LA COMPRA-->

              <article class="info-adicional-compra">
               <!--- <div class="detalle-talles">
                  <i class="fa-solid fa-ruler-combined"></i>
                  <h3 class="talles">Guía de talles</h3>
                  <i class="fa-solid fa-plus"></i>
                </div>
                <div class="cambiosDevo">
                  <i class="fa-solid fa-arrows-rotate"></i>
                  <h3 class="cambios">Cambios y devoluciones</h3>
                  <i class="fa-solid fa-plus"></i>
                </div>
                <div class="formaPago">
                  <i class="fa-solid fa-id-card"></i>
                  <h3 class="formaPago">Forma de pago</h3>
                  <i class="fa-solid fa-plus"></i>
                </div> --->
                <div class="accordion accordion-flush " id="accordionFlushExample">
                  <div class="accordion-item">
                   
                    <h3 class="accordion-header" id="flush-headingOne">
                     
                      <button style="font-size: var(--letra-pequeña); color: var(--verde-azulado)" class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne"> <i class="fa-solid fa-ruler-combined" style="font-size: var(--letra-pequeña); margin-right: 9px;"></i>
                         Guía de talles
                      </button> 
                    </h2>
                    <div id="flush-collapseOne" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                      <div class="accordion-body" style="height: 220px;"><table class="table" style="margin-bottom: 0px;">
                        <thead style="font-size: 13px;">
                          <tr>
                            <th scope="col"></th>
                            <th scope="col">1</th>
                            <th scope="col">2</th>
                            <th scope="col">3</th>
                            <th scope="col">4</th>
                            <th scope="col">5</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <th scope="row" style="font-size: 13px;">Contorno espalda</th>
                            <td style="font-size: 12px;">88-92cm</td>
                            <td style="font-size: 12px;">92-96cm</td>
                            <td style="font-size: 12px;">96-100cm</td>
                            <td style="font-size: 12px;">100-104cm</td>
                            <td style="font-size: 12px;">104-108cm</td>
                          </tr>
                          <tr>
                            <th scope="row" style="font-size: 13px;">Contorno de cintura</th>
                            <td style="font-size: 12px;">68-72cm</td>
                            <td style="font-size: 12px;">72-76cm</td>
                            <td style="font-size: 12px;">76-80cm</td>
                            <td style="font-size: 12px;">80-84cm</td>
                            <td style="font-size: 12px;">84-86cm</td>
                          </tr>
                          <tr>
                            <th scope="row" style="font-size: 13px;">Contorno de cadera</th>
                            <td style="font-size: 12px;">92-96cm</td>
                            <td style="font-size: 12px;">96-100cm</td>
                            <td style="font-size: 12px;">100-104cm</td>
                            <td style="font-size: 12px;">104-108cm</td>
                            <td style="font-size: 12px;">108-112cm</td>
                          </tr>
                        </tbody>
                      </table></div>
                    </div>
                  </div>
                  <div class="accordion-item">

                    <h3 class="accordion-header" id="flush-headingTwo">

                      <button style="font-size: var(--letra-pequeña); color: var(--verde-azulado)" class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwo" aria-expanded="false" aria-controls="flush-collapseTwo"> <i class="fa-solid fa-arrows-rotate" style="font-size: var(--letra-pequeña); margin-right: 9px;"></i>
                        Cambios y devoluciones
                      </button>
                    </h2>
                    <div id="flush-collapseTwo" class="accordion-collapse collapse" aria-labelledby="flush-headingTwo" data-bs-parent="#accordionFlushExample">
                      <div class="accordion-body" style="font-size: 14px;">Hasta 30 días de cambio luego de la compra. Sólo por otro talle o producto. Consultar siempre el stock</div>
                    </div>
                  </div>
                  <div class="accordion-item">

                    <h2 class="accordion-header" id="flush-headingThree">

                      <button style="font-size: var(--letra-pequeña); color: var(--verde-azulado)" class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseThree" aria-expanded="false" aria-controls="flush-collapseThree"><i class="fa-solid fa-id-card" style="font-size: var(--letra-pequeña); margin-right: 9px;"></i>
                        Forma de pago
                      </button>
                    </h2>
                    <div id="flush-collapseThree" class="accordion-collapse collapse" aria-labelledby="flush-headingThree" data-bs-parent="#accordionFlushExample">
                      <div class="accordion-body" style="font-size: 14px;">Recibimos todos los medios de pago. Podes abonar a través de Mercado Pago. Aceptamos visa y master. Si tenés tarjeta naranja, american o una tarjeta no bancaria podes abonar únicamente con Mercado Pago en 1 cuota. También podes abonar por transferencia bancaria y te hacemos un 15% de descuento.</div>
                    </div>
                  </div>
                </div>
              </article>

            </div>

        </section>

        <!---------------DESCRIPCIÓN DESTACADA DEL PRODUCTO MÁS EXTENSA------->

       

        <!-----OTROS PRODUCTOS------->
        <section class="otrosFav">
          <h3 class="otrosFav">OTROS PRODUCTOS</h3>
          <div class="contenedor-otros-productos">
            <% const firstId = products[0].id; %>
            <% const lastId = products[products.length - 1].id; %>
            <% const productId = product.id; %>
            
            <% function getRandomUniqueIds(firstId, lastId, count, excludeId) { 
                const uniqueIds = [];
                while (uniqueIds.length < count) {
                    const randomId = Math.floor(Math.random() * (lastId - firstId + 1)) + firstId;
                    if (!uniqueIds.includes(randomId) && randomId !== excludeId) {
                        uniqueIds.push(randomId);
                    }
                }
                return uniqueIds;
            } %>
            
            <% function randomOrder(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            } %>
            
            <% const randomIds = getRandomUniqueIds(firstId, lastId, 4, productId); %>
            <% let randomProducts = products.filter(p => randomIds.includes(p.id)); %>
            <% randomProducts = randomOrder(randomProducts); %>
            <% randomProducts.forEach((p) => { %>
                <article class="productos-otrosFav dos-continentes">
                    <img class="blazer-dos-conti" src="/images/products/<%= p.images[0] ? p.images[0].name : '' %>" 
                        alt="<%= p.name %>">
                    <a href="/producto-detalle/<%= p.id %>" class="a-dos-conti">
                        <h4 class="h4-dos-conti">
                            <%= p.name %>
                        </h4>
                    </a>
                    <p class="p-dos-conti">$<%= p.price %></p>
                </article>
            <% }); %>
          </div>
        </section>



        <div class="boton-whatsapp">
          <img src="/images/other/whatsapp.png" class="whatsapp-simbol" alt="whatsapp-símbolo" />
        </div>


        <!--------IMAGEN DE CIERRE CON MENSAJE DE LA MARCA------------->

        <div class="imagen-cierre">

          <img src="/images/banner/mensaje-de-la-marca-desktop-tablet.png" alt="banner_inferior"
            class="imagen-cierre-desk-tablet">
          <img src="/images/banner/mensaje-de-la-marca-phone.png" alt="mensaje marca mobile"
            class="imagen-cierre-mobile">
        </div>


        <!-- este codigo es para indentificar una palabra dentro de un array -->

      </main>
      <%- include("../partials/footer") %>


        <!--SCRIPT DE GLIDER-->
        <script src="/js/library/glider.min.js"></script>

        <!--SCRIPT DE CONFIGS GLIDER-->
        <script src="/js/configs/glider.js"></script>

        <!-- PERMITE AÑADIR AL CARRITO -->
        <script src="/js/functions/addProductToCart.js"></script>
        <!--VINCULACIÓN ARCHIVO PARA DINAMIZAR LA VISTA-->
        <script src="/js/functions/detailProduct.js"></script>
      
      <!-----------BOOSTRAP-------->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  </body>

</html>